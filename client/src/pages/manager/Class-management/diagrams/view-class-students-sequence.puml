@startuml View Class Students

title View Class Students

actor "Manager" as Manager
boundary "StudentsInfo" as UI
control "EnrollmentService" as Service
control "EnrollmentController" as Controller
control "EnrollmentService" as BackendService
database "Database" as DB

Manager -> UI: Navigate to class students
activate UI
UI -> Service: getStudentsByClass(classId, params)
activate Service
Service -> Controller: GET /admin-center/enrollments/class/{classId}
activate Controller
Controller -> BackendService: findByClass(classId, query)
activate BackendService
BackendService -> DB: prisma.enrollment.findMany()
activate DB
DB --> BackendService: enrollments data
deactivate DB
BackendService --> Controller: response with pagination
deactivate BackendService
Controller --> Service: API response
deactivate Controller
Service --> UI: students data
deactivate Service
UI --> Manager: display students table
deactivate UI

alt Search students
Manager -> UI: Enter search term
activate UI
UI -> Service: getStudentsByClass(classId, {search})
activate Service
Service -> Controller: GET with search params
activate Controller
Controller -> BackendService: findByClass(classId, {search})
activate BackendService
BackendService -> DB: prisma.enrollment.findMany(where: OR conditions)
activate DB
DB --> BackendService: filtered enrollments
deactivate DB
BackendService --> Controller: filtered response
deactivate BackendService
Controller --> Service: API response
deactivate Controller
Service --> UI: filtered students
deactivate Service
UI --> Manager: display filtered results
deactivate UI
end

alt Update enrollment status
Manager -> UI: Toggle graduation status
activate UI
UI -> Service: updateStatus(enrollmentId, {status})
activate Service
Service -> Controller: PUT /admin-center/enrollments/{id}/status
activate Controller
Controller -> BackendService: updateStatus(id, data)
activate BackendService
BackendService -> DB: prisma.enrollment.update()
activate DB
DB --> BackendService: updated enrollment
deactivate DB
BackendService --> Controller: success response
deactivate BackendService
Controller --> Service: API response
deactivate Controller
Service --> UI: success
deactivate Service
UI --> Manager: show success toast
deactivate UI
end

@enduml
